<!doctype html>
<html lang="en">
  
  
  

<head>
  <meta charset="utf-8">
  
    <title>Writing a Node.js application | Hyperledger Composer</title>
  
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="/composer/stable/favicon.ico">
  <meta name="google-site-verification" content="fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  
    <!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-91314349-2', 'auto');
ga('require', 'outboundLinkTracker');
ga('require', 'eventTracker');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src="/composer/stable/assets/js/autotrack.js"></script>
<!-- End Google Analytics -->

  

  
    <link href="/composer/stable/assets/css/normalize.css" rel="stylesheet">
    <link href="/composer/stable/assets/css/new-style.min.css" rel="stylesheet">
    <link href="/composer/stable/assets/css/grid-layout.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
  
</head>


<body class="">

  
  <!-- % include navbar.html % -->
  

  <div class="SiteWrapper">
    
      <div class="content">
    <article class="docs-container">
        <!-- If there's a sidebar, divide into 2 columns -->
        
        <div class="page-sidebar-grid" id="off-canvas">
          <!-- <a class="toggle close" href="#">close</a> -->
          <div class="docs-pagenav-grid">
            <!-- Navigation -->
  <nav class="navbar-docs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
            <a class="navbar-brand" href="/composer/stable/index.html"><b>Hyperledger</b> Composer</a>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <div class="top-nav-docs">
                <!-- <li>
                    <a href="services.html">Composer</a>
                </li> -->
                <!-- <li>
                    <a href="https://composer-playground.mybluemix.net/">Playground</a>
                </li> -->
                    <a href="../tutorials/tutorials.html">Tutorials</a>
                    <a href="../introduction/introduction.html">Docs</a>
                    <a href="../support/support-index.html">Community</a>
            </div>
        </div>
</nav>

          </div>

            <div class="search-form">
              <form action="/composer/stable/search/search.html" method="get">
                <!-- <label for="search-box">Search</label> -->

                <input type="text" id="search-box"  class="search-box" name="query" placeholder="Search here...">
                <input type="submit" class="submit-input hide" value="">

                <div class="search-icon">
                  <img src="/composer/stable/assets/img/Search_Icon_1.svg" class="trigger" type="submit">
                </div>
              </form>
            </div>

          <div class="docs-current-page-grid">
          <p>Writing a Node.js application</p>
          </div>

          <nav class="context-nav">
            
            
              <ul>
<li><p><a href="/composer/stable/introduction/introduction"><b>Introduction</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/introduction/key-concepts">Key Concepts</a></li>
<li><a href="/composer/stable/introduction/solution-architecture">Typical Solution Architecture</a></li>
</ul></li>
<li><p><a href="/composer/stable/installing/installing-index"><b>Installing</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/installing/installing-prereqs">Installing pre-requisites</a></li>
<li><a href="/composer/stable/installing/development-tools">Installing the development environment</a></li>
<li><a href="/composer/stable/installing/using-playground-locally">Installing Playground only</a></li>
</ul></li>
<li><p><a href="/composer/stable/tutorials/tutorials"><b>Tutorials</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/tutorials/playground-tutorial">Playground Tutorial</a></li>
<li><a href="/composer/stable/tutorials/developer-tutorial">Developer Tutorial</a></li>
<li><a href="/composer/stable/tutorials/queries">Queries Tutorial</a></li>
<li><a href="/composer/stable/tutorials/deploy-to-fabric-single-org">Deploying to a single organization Hyperledger Fabric</a></li>
<li><a href="/composer/stable/tutorials/deploy-to-fabric-multi-org">Deploying to a multi-organization Hyperledger Fabric</a></li>
</ul></li>
<li><p><a href="/composer/stable/playground/playground-index"><b>Using Playground</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/playground/id-cards-playground">Business Network Cards</a></li>
</ul></li>
<li><p><a href="/composer/stable/business-network/business-network-index"><b>Developing Business Networks</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/business-network/businessnetworkdefinition">Business Network Definitions</a></li>
<li><a href="/composer/stable/business-network/bnd-create">Create a Business Network Definition</a></li>
<li><a href="/composer/stable/business-network/bnd-deploy">Deploying Business Networks</a></li>
<li><a href="/composer/stable/business-network/publishing-events">Emitting Events</a></li>
<li><a href="/composer/stable/business-network/testing">Testing Business Networks</a></li>
<li><a href="/composer/stable/business-network/bnd-publish">Publish Models or Business Network Definitions</a></li>
<li><a href="/composer/stable/business-network/query">Using Queries and Filters with Business Network Data</a></li>
<li><a href="/composer/stable/business-network/programmatic-access-control">Programmatic access control</a></li>
<li><a href="/composer/stable/business-network/historian">Hyperledger Composer Historian</a></li>
</ul></li>
<li><p><a href="/composer/stable/applications/applications-index"><b>Developing Applications</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/applications/node">Writing a Node.js application</a></li>
<li><a href="/composer/stable/applications/web">Writing Web or mobile applications</a></li>
<li><a href="/composer/stable/applications/subscribing-to-events">Subscribing to events</a></li>
</ul></li>
<li><p><a href="/composer/stable/integrating/integrating-index"><b>Integrating Existing Systems</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/integrating/getting-started-rest-api">Generating a REST API</a></li>
<li><a href="/composer/stable/integrating/publishing-events">Publishing events from the REST server</a></li>
<li><a href="/composer/stable/integrating/enabling-rest-authentication">Enabling authentication for the REST server</a></li>
<li><a href="/composer/stable/integrating/enabling-multiuser">Enabling multiple user mode for the REST server</a></li>
<li><a href="/composer/stable/integrating/securing-the-rest-server">Securing the REST server using HTTPS and TLS</a></li>
<li><a href="/composer/stable/integrating/deploying-the-rest-server">Deploying the REST server for a business network</a></li>
<li><a href="/composer/stable/integrating/node-red">Integrating with Node-RED</a></li>
<li><a href="/composer/stable/integrating/call-out">Calling external REST services</a></li>
</ul></li>
<li><p><a href="/composer/stable/managing/managingindex"><b>Managing a Deployed Business Network</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/managing/participantsandidentities">Participants and identities</a></li>
<li><a href="/composer/stable/managing/participant-add">Adding participants</a></li>
<li><a href="/composer/stable/managing/id-cards-playground">Creating, Exporting, and Importing Business Network Cards</a></li>
<li><a href="/composer/stable/managing/identity-issue">Issuing a new identity to a participant</a></li>
<li><a href="/composer/stable/managing/identity-bind">Binding an existing identity to a participant</a></li>
<li><a href="/composer/stable/managing/identity-list">Listing all identities in a business network</a></li>
<li><a href="/composer/stable/managing/identity-revoke">Revoking an identity from a participant</a></li>
<li><a href="/composer/stable/managing/updating-composer">Updating the Hyperledger Composer Runtime</a></li>
</ul></li>
<li><p><a href="/composer/stable/problems/diagnostics"><b>Diagnosing Problems</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
<li><p><a href="/composer/stable/reference/reference-index"><b>Reference</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/reference/MeetTheModules">Hyperledger Composer npm Modules</a></li>
<li><a href="/composer/stable/reference/cto_language">Modeling Language</a></li>
<li><a href="/composer/stable/reference/acl_language">Access Control Language</a></li>
<li><a href="/composer/stable/reference/query-language">Query Language</a></li>
<li><a href="/composer/stable/reference/model-compatibility">Model Compatibility</a></li>
<li><a href="/composer/stable/reference/connectionprofile">Connection Profiles</a></li>
<li><a href="/composer/stable/reference/js_scripts">Transaction Processor Functions</a></li>
<li><a href="/composer/stable/reference/commands">Hyperledger Composer CLI Commands</a></li>
<li><a href="/composer/stable/reference/rest-server">Hyperledger Composer REST Server</a></li>
<li><a href="/composer/stable/reference/glossary">Hyperledger Composer Glossary of Terms</a></li>
</ul></li>
<li><p><a href="/composer/stable/support/support-index"><b>Support</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
<li><p><a href="/composer/stable/api/api-doc-index"><b>API Reference</b><img src="/composer/stable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="/composer/stable/api/allData">API Class Index</a></li>
<li><a href="/composer/stable/api/admin-adminconnection">AdminConnection (Admin API)</a></li>
<li><a href="/composer/stable/api/client-assetregistry">AssetRegistry (Client API)</a></li>
<li><a href="/composer/stable/api/client-businessnetworkconnection">BusinessNetworkConnection (Client API)</a></li>
<li><a href="/composer/stable/api/client-historian">Historian (Client API)</a></li>
<li><a href="/composer/stable/api/client-identityregistry">IdentityRegistry (Client API)</a></li>
<li><a href="/composer/stable/api/client-participantregistry">ParticipantRegistry (Client API)</a></li>
<li><a href="/composer/stable/api/client-query">Query (Client API)</a></li>
<li><a href="/composer/stable/api/client-registry">Registry (Client API)</a></li>
<li><a href="/composer/stable/api/client-transactionregistry">TransactionRegistry (Client API)</a></li>
<li><a href="/composer/stable/api/common-assetdeclaration">AssetDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-businessnetworkcardstore">BusinessNetworkCardStore (Common API)</a></li>
<li><a href="/composer/stable/api/common-businessnetworkdefinition">BusinessNetworkDefinition (Common API)</a></li>
<li><a href="/composer/stable/api/common-businessnetworkmetadata">BusinessNetworkMetadata (Common API)</a></li>
<li><a href="/composer/stable/api/common-classdeclaration">ClassDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-conceptdeclaration">ConceptDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-concept">Concept (Common API)</a></li>
<li><a href="/composer/stable/api/common-enumdeclaration">EnumDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-enumvaluedeclaration">EnumValueDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-eventdeclaration">EventDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-factory">Factory (Common API)</a></li>
<li><a href="/composer/stable/api/common-filesystemcardstore">FileSystemCardStore (Common API)</a></li>
<li><a href="/composer/stable/api/common-functiondeclaration">FunctionDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-idcard">IdCard (Common API)</a></li>
<li><a href="/composer/stable/api/common-identifiable">Identifiable (Common API)</a></li>
<li><a href="/composer/stable/api/common-introspector">Introspector (Common API)</a></li>
<li><a href="/composer/stable/api/common-memorycardstore">MemoryCardStore (Common API)</a></li>
<li><a href="/composer/stable/api/common-modelfile">ModelFile (Common API)</a></li>
<li><a href="/composer/stable/api/common-modelmanager">ModelManager (Common API)</a></li>
<li><a href="/composer/stable/api/common-participantdeclaration">ParticipantDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-property">Property (Common API)</a></li>
<li><a href="/composer/stable/api/common-relationshipdeclaration">RelationshipDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-relationship">Relationship (Common API)</a></li>
<li><a href="/composer/stable/api/common-resource">Resource (Common API)</a></li>
<li><a href="/composer/stable/api/common-serializer">Serializer (Common API)</a></li>
<li><a href="/composer/stable/api/common-transactiondeclaration">TransactionDeclaration (Common API)</a></li>
<li><a href="/composer/stable/api/common-typed">Typed (Common API)</a></li>
<li><a href="/composer/stable/api/common-validatedconcept">ValidatedConcept (Common API)</a></li>
<li><a href="/composer/stable/api/common-validatedresource">ValidatedResource (Common API)</a></li>
<li><a href="/composer/stable/api/runtime-api">Api (Runtime API)</a></li>
<li><a href="/composer/stable/api/runtime-assetregistry">AssetRegistry (Runtime API)</a></li>
<li><a href="/composer/stable/api/runtime-factory">Factory (Runtime API)</a></li>
<li><a href="/composer/stable/api/runtime-participantregistry">ParticipantRegistry (Runtime API)</a></li>
<li><a href="/composer/stable/api/runtime-query">Query (Runtime API)</a></li>
<li><a href="/composer/stable/api/runtime-serializer">Serializer (Runtime API)</a></li>
</ul></li>
</ul>

            
                <div class="docs-footer-grid">
                <div class="footer-bg-break docs-footer-break">
<div class="footer-container-break">
    <div class="footer-left-break">
      <p>Released under the Apache License v2.0</p>
    </div>
  <div class="footer-right-break">
    <ul>
      <li><a href="https://github.com/hyperledger/composer">GitHub</a></li>
      <li><a href="http://stackoverflow.com/questions/tagged/fabric-composer">Stack Overflow</a></li>
      <li><a href="https://goo.gl/forms/7YPMLP2LTN2hjIRk2">Feedback?</a></li>
    </ul>
  </div>
</div>
</div>

                </div>
          </nav>
        </div>
        <div class="page-content-grid">
          <section class="content-chunk">
            <!-- <a class="toggle open" href="#nav">open</a> -->
            
              <h1 id="writing-node-js-applications">Writing Node.js Applications</h1>

<p>Application developers use the <code>composer-client</code> npm module to programmatically connect to a deployed business network, create, read, update and delete assets and participants and to submit transactions. If applications need to be able to deploy or administer business networks, then the <code>composer-admin</code> npm module can be used.</p>

<p>The sample <a href="https://github.com/hyperledger/composer-sample-applications/blob/master/packages/digitalproperty-app/lib/landRegistry.js"><code>landregistry.js</code></a> file contains a class to the represent the land regsitry and contains methods for listing the land titles, adding default titles, and submitting the transaction. This has been implemented using a JavaScript class; however you are free to structure your code as you wish.</p>

<p>It&#39;s worth highlighting that the style of the API is to use promises. Typically Hyperledger Composer APIs will return a promise that is resolved when the operation has been successfully completed or with the result of the operation if applicable.</p>

<p>If you&#39;re not familiar with Promise based development it&#39;s worth reviewing some of the tutorials online to get an idea.</p>

<h2 id="modules-required">Modules required</h2>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">BusinessNetworkConnection</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'composer-client'</span><span class="p">).</span><span class="nx">BusinessNetworkConnection</span><span class="p">;</span>
</code></pre></div>
<p>For a Hyperledger Composer client application this is the only npm module required.</p>

<h2 id="connecting-to-the-hyperledger-composer-runtime">Connecting to the Hyperledger Composer Runtime</h2>

<p>A BusinessNetworkConnection instance is created and then used to connect to a runtime:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BusinessNetworkConnection</span><span class="p">();</span>
<span class="k">this</span><span class="p">.</span><span class="nx">cardName</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'cardName'</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="nx">businessNetworkIdentifier</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'businessNetworkIdentifier'</span><span class="p">);</span>
</code></pre></div>
<p>The first Hyperledger Composer API call that we are going to make here, is the connect() API, to establish the connection to the Hyperledger Composer runtime on the Hyperledger Fabric.
This API returns a Promise to the businessNetworkDefinition if successful:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cardName</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">businessNetworkDefinition</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<p>For a client application this is all the essential setup that is required, from this point on it&#39;s up to what the application wants to do as to what APIs are called.</p>

<h2 id="adding-assets-to-a-registry">Adding assets to a registry</h2>

<p>The Hyperledger Composer runtime will create a default registry for each type of modeled asset. So in this example, a LandTitle registry will have been created. What we want to do here is get access to that registry and then add some assets. The <code>getAssetRegistry()</code> method takes the fully qualified asset name as defined in the CTO model file (that is the namespace plus the name of the asset type). It returns a promise that is resolved with the asset registry:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">getAssetRegistry</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork.LandTitle'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">titlesRegistry</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<p>Next step is to create some assets (look for the method <code>_bootstrapTitles</code> in the code )</p>

<p>A factory style pattern is used to create assets. A factory is obtained from the businessNetworkDefinition and used to create instances of all the types defined in the business network.  Note the use of the namespace and asset name.  Then we can set the properties of this asset. The identifiers here (firstName lastName) matches with the properties defined in the model.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">let</span> <span class="nx">factory</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">businessNetworkDefinition</span><span class="p">.</span><span class="nx">getFactory</span><span class="p">();</span>
<span class="nx">owner</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">newResource</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork'</span><span class="p">,</span> <span class="s1">'Person'</span><span class="p">,</span> <span class="s1">'PID:1234567890'</span><span class="p">);</span>
<span class="nx">owner</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="s1">'Fred'</span><span class="p">;</span>
<span class="nx">owner</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="s1">'Bloggs'</span><span class="p">;</span>
</code></pre></div>
<p>We now have a Person! Now we need a land title. Note how the owner is specified as being the person we just created. (In the actual sample code we do this code twice to create landTitle1 and landTitle2).</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">let</span> <span class="nx">landTitle2</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">newResource</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork'</span><span class="p">,</span> <span class="s1">'LandTitle'</span><span class="p">,</span> <span class="s1">'LID:6789'</span><span class="p">);</span>
<span class="nx">landTitle2</span><span class="p">.</span><span class="nx">owner</span> <span class="o">=</span> <span class="nx">owner</span><span class="p">;</span>
<span class="nx">landTitle2</span><span class="p">.</span><span class="nx">information</span> <span class="o">=</span> <span class="s1">'A small flat in the city'</span><span class="p">;</span>
</code></pre></div>
<p>We now have a land title created that needs to be stored in the registry.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">titlesRegistry</span><span class="p">.</span><span class="nx">addAll</span><span class="p">([</span><span class="nx">landTitle1</span><span class="p">,</span> <span class="nx">landTitle2</span><span class="p">]);</span>
</code></pre></div>
<p>This is using an API to add multiple titles, which returns a promise that is resolved when the assets are added. The last thing we need to do is add the Person, Fred Bloggs. As this is a &#39;participant&#39;, the getParticipantRegistry API is used.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">getParticipantRegistry</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork.Person'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">personRegistry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">personRegistry</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">owner</span><span class="p">);</span>
  <span class="p">})</span>
</code></pre></div>
<h2 id="listing-assets-in-a-regsitry">Listing assets in a regsitry</h2>

<p>In the sample application this is handled in a different method <code>list()</code>.  The same setup as for putting assets is required, so as before we need to get the asset registry but this tile we call the getAll() API. This returns an array of objects.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">getAssetRegistry</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork.LandTitle'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">registry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="k">return</span> <span class="nx">registry</span><span class="p">.</span><span class="nx">getAll</span><span class="p">();</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">aResources</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// instantiate</span>
  <span class="kd">let</span> <span class="nx">table</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Table</span><span class="p">({</span>
    <span class="na">head</span><span class="p">:</span> <span class="p">[</span><span class="s1">'TitleID'</span><span class="p">,</span> <span class="s1">'OwnerID'</span><span class="p">,</span> <span class="s1">'First Name'</span><span class="p">,</span> <span class="s1">'Surname'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'ForSale'</span><span class="p">]</span>
  <span class="p">});</span>
  <span class="kd">let</span> <span class="nx">arrayLength</span> <span class="o">=</span> <span class="nx">aResources</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arrayLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">tableLine</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">titleId</span><span class="p">);</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">owner</span><span class="p">.</span><span class="nx">personId</span><span class="p">);</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">owner</span><span class="p">.</span><span class="nx">firstName</span><span class="p">);</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">owner</span><span class="p">.</span><span class="nx">lastName</span><span class="p">);</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">information</span><span class="p">);</span>
    <span class="nx">tableLine</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">aResources</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">forSale</span> <span class="p">?</span> <span class="s1">'Yes'</span> <span class="p">:</span> <span class="s1">'No'</span><span class="p">);</span>
    <span class="nx">table</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tableLine</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="c1">// Put to stdout - as this is really a command line app</span>
  <span class="k">return</span><span class="p">(</span><span class="nx">table</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div>
<p>Most of this isn&#39;t Hyperledger Composer API code - but it shows how to access the details of the objects that have been returned. At this point it&#39;s worth just looking again at the model.</p>
<div class="highlight"><pre><code class="language-" data-lang="">asset LandTitle identified by titleId {
  o String   titleId
  o Person   owner
  o String   information
  o Boolean  forSale   optional
}

participant Person identified by personId {
  o String personId
  o String firstName
  o String lastName
}
</code></pre></div>
<p>You can see how the owner and title information are being accessed in a very simple manner.</p>

<h2 id="submitting-a-transactions">Submitting a transactions</h2>

<p>The last thing that we need to do is submit a transaction. This is the definition of the transaction in the model file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">transaction RegisterPropertyForSale identified by transactionId{
  o String transactionId
  --&gt; LandTitle title
}
</code></pre></div>
<p>The transaction has two fields here, a trandsactionId, and a reference to the land title that should be submitted for sale. The first step is get access to the registry for the landtitle, and get back the specific land title we want to submit for sale.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">getAssetRegistry</span><span class="p">(</span><span class="s1">'net.biz.digitalPropertyNetwork.LandTitle'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">registry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">registry</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'LID:1148'</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div>
<p>The getAssetRegistry call should now be looking a bit familiar, the get API is used to get a specific land title.
The next step is to create the transaction we want to submit.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">let</span> <span class="nx">serializer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">businessNetworkDefinition</span><span class="p">.</span><span class="nx">getSerializer</span><span class="p">();</span>

<span class="kd">let</span> <span class="nx">resource</span> <span class="o">=</span> <span class="nx">serializer</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">({</span>
  <span class="s1">'$class'</span><span class="p">:</span> <span class="s1">'net.biz.digitalPropertyNetwork.RegisterPropertyForSale'</span><span class="p">,</span>
  <span class="s1">'title'</span><span class="p">:</span> <span class="s1">'LID:1148'</span>
<span class="p">});</span>

<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">bizNetworkConnection</span><span class="p">.</span><span class="nx">submitTransaction</span><span class="p">(</span><span class="nx">resource</span><span class="p">);</span>

</code></pre></div>
<p>What we need to do here is create a &#39;serializer&#39;.  This is able to create a resource - this resource is then passed to the submitTransaction API. Note that the transaction JSON matches the structure specified in the model file.</p>

<h2 id="references">References</h2>

<ul>
<li><a href="../api/api-doc-index.html"><strong>JavaScript API Documentation</strong></a></li>
<li><a href="https://scotch.io/tutorials/understanding-javascript-promises-pt-i-background-basics"><strong>Promises tutorial</strong></a></li>
</ul>

            
          </section>
        </div>
        <!-- Otherwise, have the main content fill all 12 columns... -->
        
      <div class="PageNavigation">
    
    
  </div>
    </article>
</div>
<script>
(function (document) {
    function clipboard_init() {
        var charts = document.querySelectorAll("div.highlight"),
            arr = [],
            i, j, maxItem, pre, btn, el;

        // Make sure we are dealing with an array
        for(i = 0, maxItem = charts.length; i < maxItem; i++) arr.push(charts[i]);

        // Find the UML source element and get the text
        for (i = 0, maxItem = arr.length; i < maxItem; i++) {
            el = arr[i];
            pre = el.childNodes[0];

            pre.id = "hl_code" + i.toString();
            btn = document.createElement('copy-button');
            btn.appendChild(document.createTextNode('Copy'));
            btn.setAttribute("class", "copy-btn");
            btn.setAttribute("data-clipboard-target", "#hl_code" + i.toString());
            el.insertBefore(btn, pre);
        }
        new Clipboard('.copy-btn');
    };

    function onReady(fn) {
        if (document.addEventListener) {
            document.addEventListener('DOMContentLoaded', fn);
        } else {
            document.attachEvent('onreadystatechange', function() {
                if (document.readyState === 'interactive')
                    fn();
            });
        }
    }

    onReady(function(){
        clipboard_init();
    });
})(document);
</script>
<script src="/composer/stable/assets/js/nav.js"></script>
<script src="/composer/stable/assets/js/search_bar.js"></script>

    

    


  </div>
</body>
</html>
