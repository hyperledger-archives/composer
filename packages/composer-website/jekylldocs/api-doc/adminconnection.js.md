---
layout: default
title: Admin adminconnection.js
section: api
sidebar: sidebars/accordion-toc0.md
excerpt: The Client, Admin, and Runtime components of Hyperledger Composer .
index-order: 1209
---

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [AdminConnection](#adminconnection)
-   [connect](#connect)
-   [createProfile](#createprofile)
-   [deleteProfile](#deleteprofile)
-   [getProfile](#getprofile)
-   [getAllProfiles](#getallprofiles)
-   [disconnect](#disconnect)
-   [install](#install)
-   [start](#start)
-   [deploy](#deploy)
-   [undeploy](#undeploy)
-   [update](#update)
-   [ping](#ping)
-   [list](#list)
-   [importIdentity](#importidentity)
-   [requestIdentity](#requestidentity)
-   [exportIdentity](#exportidentity)
-   [upgrade](#upgrade)
-   [setLogLevel](#setloglevel)
-   [getLogLevel](#getloglevel)

## AdminConnection

This class creates an administration connection to a Hyperledger Composer runtime. The
connection can then be used to:

<ul>
<li>Deploy BusinessNetworkDefinitions</li>
<li>Undeploy BusinessNetworkDefinitions</li>
<li>Update BusinessNetworkDefinitions</li>
<li>Send a ping message to the runtime to ensure it is running and
correctly configured.</li>
<li>Store a connection profile document in the connection profile store</li>
</ul>

**Parameters**

-   `options`  

## connect

Connects and logs in to the Hyperledger Fabric using a named connection
profile. The connection profile must exist in the profile store.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the connection profile
-   `enrollmentID` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the enrollment ID of the user
-   `enrollmentSecret` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the enrollment secret of the user
-   `businessNetworkIdentifier` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the id of the network (for update) or null

**Examples**

```javascript
// Connect to Hyperledger Fabric
var adminConnection = new AdminConnection();
adminConnection.connect('testprofile', 'WebAppAdmin', 'DJY27pEnl16d')
.then(function(){
    // Connected.
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that indicates the connection is complete

## createProfile

Stores a connection profile into the profile store being used by this
AdminConnection.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the connection profile
-   `data` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The connection profile data

**Examples**

```javascript
// Create a connection profile
var adminConnection = new AdminConnection();
var adminOptions = {
    type: 'hlf',
    keyValStore: '/tmp/keyValStore',
    membershipServicesURL: 'grpc://membersrvc:7054',
    peerURL: 'grpc://vp0:7051',
    eventHubURL: 'grpc://vp0:7053'
};
return adminConnection.createProfile('testprofile', adminOptions)
.then(function(){
    // Created profile
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that indicates that the connection profile is deployed

## deleteProfile

Deletes the specified connection profile from the profile store being used by this
AdminConnection.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the connection profile

**Examples**

```javascript
// Delete a connection profile
var adminConnection = new AdminConnection();
return adminConnection.deleteProfile('testprofile')
.then(function(){
    // Deleted profile
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that indicates that the connection profile is deployed

## getProfile

Retrieve the specified connection profile from the profile store being
used by this AdminConnection.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the connection profile

**Examples**

```javascript
// Retrieve the connection profile.
const adminConnection = new AdminConnection();
return adminConnection.getProfile('testprofile')
  .then((profile) => {
    // Retrieved profile
    console.log(profile);
  });
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that is resolved with the connection profile data.

## getAllProfiles

Retrieve all connection profiles from the profile store being used by this
AdminConnection.

**Examples**

```javascript
// Retrieve all the connection profiles.
const adminConnection = new AdminConnection();
return adminConnection.getAllProfiles()
  .then((profiles) => {
    // Retrieved profiles
    for (let profile in profiles) {
      console.log(profile, profiles[profile]);
    }
  });
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that is resolved with the connection profile data.

## disconnect

Disconnects this connection.

**Examples**

```javascript
// Disconnect from a Business Network
var adminConnection = new AdminConnection();
return adminConnection.disconnect()
.then(function(){
    // Disconnected.
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be resolved when the connection is
terminated.

## install

Installs the Hyperledger Composer runtime to the Hyperledger Fabric in preparation
for the business network to be started. The connection mustbe connected for this method to succeed.
You must pass the name of the business network that is defined in your archive that this
runtime will be started with.

**Parameters**

-   `businessNetworkIdentifier` **BusinessNetworkIdentifier** The name of business network which will be used to start this runtime.
-   `installOptions` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** connector specific install options

**Examples**

```javascript
// Install the Hyperledger Composer runtime
var adminConnection = new AdminConnection();
var businessNetworkDefinition = BusinessNetworkDefinition.fromArchive(myArchive);
return adminConnection.install(businessNetworkDefinition.getName())
.then(function(){
    // Business network definition installed
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the business network has been
deployed.

## start

Starts a business network within the runtime previously installed to the Hyperledger Fabric with
the same name as the business network to be started. The connection must be connected for this
method to succeed.

**Parameters**

-   `businessNetworkDefinition` **BusinessNetworkDefinition** The business network to start
-   `startOptions` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** connector specific start options

**Examples**

```javascript
// Start a Business Network Definition
var adminConnection = new AdminConnection();
var businessNetworkDefinition = BusinessNetworkDefinition.fromArchive(myArchive);
return adminConnection.start(businessNetworkDefinition)
.then(function(){
    // Business network definition is started
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the business network has been
deployed.

## deploy

Deploys a new BusinessNetworkDefinition to the Hyperledger Fabric. The connection must
be connected for this method to succeed.

**Parameters**

-   `businessNetworkDefinition` **BusinessNetworkDefinition** The business network to deploy
-   `deployOptions` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** connector specific deployment options

**Examples**

```javascript
// Deploy a Business Network Definition
var adminConnection = new AdminConnection();
var businessNetworkDefinition = BusinessNetworkDefinition.fromArchive(myArchive);
return adminConnection.deploy(businessNetworkDefinition)
.then(function(){
    // Business network definition deployed
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the business network has been
deployed.

## undeploy

Undeploys a BusinessNetworkDefinition from the Hyperledger Fabric. The business network will no
longer be able to process transactions.

**Parameters**

-   `businessNetworkIdentifier` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The identifier of the network to undeploy

**Examples**

```javascript
// Undeploy a Business Network Definition
var adminConnection = new AdminConnection();
return adminConnection.undeploy('identifier')
.then(function(){
    // Undeployed Business Network Definition
})
.catch(function(error){
    // Add optional error handling here.
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the business network has been
undeployed.

## update

Updates an existing BusinessNetworkDefinition on the Hyperledger Fabric. The BusinessNetworkDefinition
must have been previously deployed.

**Parameters**

-   `businessNetworkDefinition` **BusinessNetworkDefinition** The new BusinessNetworkDefinition

**Examples**

```javascript
// Updates a Business Network Definition
var adminConnection = new AdminConnection();
var businessNetworkDefinition = BusinessNetworkDefinition.fromArchive(myArchive);
return adminConnection.update(businessNetworkDefinition)
.then(function(){
    // Business network definition updated
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the business network has been
updated.

## ping

Test the connection to the runtime and verify that the version of the
runtime is compatible with this level of the node.js module.

**Examples**

```javascript
// Test the connection to the runtime
var adminConnection = new AdminConnection();
return adminConnection.ping()
.then(function(){
    // Connection has been tested
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the connection has
been tested. The promise will be rejected if the version is incompatible.

## list

List all of the deployed business networks. The connection must
be connected for this method to succeed.

**Examples**

```javascript
// List all of the deployed business networks.
var adminConnection = new AdminConnection();
return adminConnection.list()
.then((businessNetworks) => {
    // Connection has been tested
    return businessNetworks.forEach((businessNetwork) => {
      console.log('Deployed business network', businessNetwork);
    });
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be resolved with an array of
business network identifiers, or rejected with an error.

## importIdentity

Import an identity into a profiles' wallet. No connection needs to be established
for this method to succeed.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the connection profile
-   `id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The id to associate with this identity
-   `certificate` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The signer cert in PEM format
-   `privateKey` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The private key in PEM format

**Examples**

```javascript
// Import an identity into a profiles' wallet
var adminConnection = new AdminConnection();
return adminConnection.importIdentity('hlfv1', 'PeerAdmin', certificate, privateKey)
.then(() => {
    // Identity imported
    console.log('identity imported successfully');
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise which is resolved when the identity is imported

## requestIdentity

Request the certificates for an identity. No connection needs to be established
for this method to succeed.

**Parameters**

-   `connectionProfile` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the connection profile
-   `enrollmentID` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The ID to enroll
-   `enrollmentSecret` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The secret for the ID

**Examples**

```javascript
// Request the cryptographic material for am identity of a hlf v1 environment.
var adminConnection = new AdminConnection();
return adminConnection.requestIdentity('hlfv1', 'admin', 'adminpw')
.then((response) => {
    // Identity returned
    console.log('public signing certificate:');
    console.log(response.certificate);
    console.log('private key:');
    console.log(response.key);
    console.log('ca root certificate:');
    console.log(response.rootCertificate);
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise which is resolved when the identity is imported

## exportIdentity

Obtain the credentials associated with a given identity.

**Parameters**

-   `connectionProfileName` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the connection profile.
-   `id` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the identity.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** Resolves to credentials in the form <em>{ certificate: String, privateKey: String }</em>.

## upgrade

Upgrades an existing business network's composer runtime to a later level.
The connection must be connected specifying the business network identifier as part of the
connection for this method to succeed.

**Examples**

```javascript
// Upgrade the Hyperledger Composer runtime
var adminConnection = new AdminConnection();
var businessNetworkDefinition = BusinessNetworkDefinition.fromArchive(myArchive);
return adminConnection.connect(connectionProfileName, upgradeId, upgradeSecret, businessNetworkDefinition.getName())
.then(() => {
     return adminConnection.upgrade();
})
.then(() => {
    // Business network definition upgraded
})
.catch((error) => {
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that will be fufilled when the composer runtime has been upgraded,
or rejected otherwise.

## setLogLevel

Set the logging level of a business network. The connection must
be connected for this method to succeed.

**Parameters**

-   `newLogLevel` **any** new logging level

**Examples**

```javascript
// Set the logging level of a business network.
var adminConnection = new AdminConnection();
return adminConnection.setLogLevel('DEBUG')
.then(() => {
    console.log('log level set to DEBUG');
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that resolves if successful.

## getLogLevel

Get the current logging level of a business network. The connection must
be connected for this method to succeed.

**Examples**

```javascript
// Get the current logging level of a business network.
var adminConnection = new AdminConnection();
return adminConnection.getLogLevel()
.then((currentLogLevel) => {
    console.log('current log level is ' + currentLogLevel);
})
.catch(function(error){
    // Add optional error handling here.
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that resolves with the current logging level if successful.
