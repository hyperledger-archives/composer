<h1 id="building-your-first-business-network">Building your first business network</h1>

<hr />

<p>Defining a business network is the entry point to any  project. The business network contains participants, assets, and transactions. This tutorial walks you through the basics of defining a business network of your own, the contents of a business network, and how they come together to form a business network archive.</p>

<hr />

<h2 id="before-you-begin">Before you begin</h2>

<p>Before beginning this tutorial you will need:</p>

<ul>
  <li>A GitHub account</li>
  <li>If you want to run this tutorial locally, see <a href="../tutorials/getting-started-playground.html">Installing and running the  Playground locally</a>.</li>
</ul>

<hr />

<h2 id="lets-get-started---importing-the-sample">Let’s get started - Importing the sample</h2>

<ol>
  <li>
    <p>Open the <a href="https://composer-playground.mybluemix.net"> Playground</a>. On the left are three files, a script file, <code class="highlighter-rouge">lib/logic.js</code> which represents transaction logic, a model file, <code class="highlighter-rouge">lib/org.acme.biznet.cto</code> which defines the participants assets and transactions of the business network, and an access control file, <code class="highlighter-rouge">permissions.acl</code> which defines the access different participants have.</p>
  </li>
  <li>
    <p>To get set up with a sample business network click <strong>Import/Replace</strong>. This dialog allows you to import your own business network archive <code class="highlighter-rouge">.bna</code> files, or to import our premade business network samples. For now we’ll use a pre-built sample from the  GitHub repository. Click <strong>Authenticate with GitHub</strong> then log into your GitHub account and click <strong>Authorize application</strong>.</p>
  </li>
  <li>
    <p>From the menu, select <strong>carauction-network</strong> and click <strong>Deploy</strong>. This imports the car auction sample business network into your playground instance. In the model file <code class="highlighter-rouge">lib/org.acme.vehicle.auction.cto</code> there are the definitions of asset types, participant types, and transactions. The entries in the <code class="highlighter-rouge">.cto</code> file define the expected format of each asset, participant, and transaction. The script file <code class="highlighter-rouge">lib/logic.js</code> contains JavaScript
which controls the transactions, in this script file, there is JavaScript logic controlling the <code class="highlighter-rouge">Close Bidding</code> and <code class="highlighter-rouge">Make Offer</code> transactions.</p>
  </li>
</ol>

<h3 id="setting-up-the-auction">Setting up the auction</h3>

<ol>
  <li>
    <p>To get a better understanding of how business network definitions work in practise, click the <strong>Test</strong> tab at the top. From this screen, we can create assets and participants, and submit transactions.</p>
  </li>
  <li>
    <p>To start with, add a <em>Member</em> participant by clicking <strong>Member</strong> then clicking <strong>Create New Participant</strong>. Enter the balance, email, and name credentials for the new participant in the following format, then click <strong>Create New</strong>. The credentials which are required for each participant are defined in the <code class="highlighter-rouge">.cto</code> file viewable in the <strong>Define</strong> tab.</p>
  </li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"$class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.acme.vehicle.auction.Member"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alice@biznet.org"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Alice"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<ol>
  <li>
    <p>Create two more <em>Members</em> in the same way as step 5, with different balance, email, and name credentials. Then, click the <strong>Auctioneer</strong> participant type on the left, and then create an Auctioneer participant by click <strong>Create New Participant</strong>.</p>
  </li>
  <li>
    <p>Now that there are three <em>Members</em>; two to bid against each other and another to be the initial owner of the <em>Vehicle</em> asset. We also have an <em>Auctioneer</em> to close the bidding. Next we need an assets, in this case a <em>Vehicle</em> asset, for them to bid over, and a <em>Vehicle Listing</em> asset to control the reserve price and record the current highest offer.</p>
  </li>
  <li>
    <p>To create a <em>Vehicle</em> asset, click <strong>Vehicle</strong>, then <strong>Create New Asset</strong>. Enter the VIN (Vehicle Identification Number) and the email address of the owner. In this case, enter the email address of one of the <em>Members</em> created in step 5 or 6, then click <strong>Create New</strong> to finish creating the asset. Now, the asset exists and has a set owner. The <em>Vehicle</em> asset credentials must be in the following format, as defined in the <code class="highlighter-rouge">.cto</code> file.</p>
  </li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"$class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.acme.vehicle.auction.Vehicle"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"vin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dave@biznet.org"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<ol>
  <li>Next, to sell the car at auction, an auction listing asset must be created. Assets can be any tangible or intangible goods or services, in this case, the auction listing itself. To create the auction listing, click <strong>VehicleListing</strong> then click <strong>Create New Asset</strong>. The <em>VehicleListing</em> requires several properties, and should have the following format:</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"$class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.acme.vehicle.auction.VehicleListing"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"listingId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"listing_1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"reservePrice"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dave's car"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FOR_SALE"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"offers"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"vehicle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="running-the-auction">Running the auction</h3>

<ol>
  <li>Now that you have <em>Members</em> to own and bid on an asset, an <em>Auctioneer</em>, a <em>Vehicle</em> asset with registered ownership, and a <em>VehicleListing</em> asset to track the bids, reserve price, and state of the auction. The next step is to begin using transactions to interact with assets. This sample includes the <em>Offer</em> and <em>CloseBidding</em> transactions. Transactions, combined with assets and participants, make up the economic model of a business network. Transactions can modify, transfer, or otherwise alter assets, as in this sample, where transactions allow participants to place bids or allow the auctioneer to close the auction. Placing a bid uses the <em>Offer</em> transaction. To submit a transaction, click the <strong>Submit Transaction</strong> button. In the dialog box, use the dropdown to select the <em>Offer</em> transaction type. The <em>Offer</em> transaction requires a number of properties and should have the following format:</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"$class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.acme.vehicle.auction.Offer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bidPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"listing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"listing_1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alice@biznet.org"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<ol>
  <li>
    <p>Now that you’ve submitted an <em>Offer</em> transaction, we can check that it has been successfully applied to the <em>VehicleListing</em> asset. Click <strong>VehicleListing</strong> and then click <strong>Show All</strong> in your listing entry. You should see that there is now an entry for the <em>Offer</em> transaction in the <code class="highlighter-rouge">offers</code> property of the listing asset. Congratulations, you’ve just made your first bid!</p>
  </li>
  <li>
    <p>To represent a counter-offer or raise from another member, repeat step 10, increasing the <code class="highlighter-rouge">bidPrice</code> property and changing the <code class="highlighter-rouge">member</code> who is placing the bid. After you have submitted a second <em>Offer</em> transaction, the <em>VehicleListing</em> asset should update to show that both bids have been placed.</p>
  </li>
  <li>
    <p>When you’ve placed as many bids as you like, the next step is to submit the <em>CloseBidding</em> transaction to close the auction. The <em>CloseBidding</em> transaction pays the previous owner of the <em>Vehicle</em> asset listed in the <em>VehicleListing</em> the current highest offer, changes the <code class="highlighter-rouge">state</code> of the listing to <code class="highlighter-rouge">SOLD</code>, and transfers ownership of the <em>Vehicle</em> asset, as listed in the <code class="highlighter-rouge">owner</code> property, to the highest bidder. To submit the <em>CloseBidding</em> transaction, click <strong>Submit Transaction</strong> and enter the <code class="highlighter-rouge">listingId</code> which corresponds to the <em>VehicleListing</em>. Click <strong>Submit</strong> to submit the transaction. Once the transaction has been submitted, you can check the <em>Vehicle</em> asset’s <code class="highlighter-rouge">owner</code> property to ensure that it has changed, as well as checking the <code class="highlighter-rouge">balance</code> of the previous and new owner of the car, and the <em>VehicleListing</em> <code class="highlighter-rouge">state</code>.</p>
  </li>
  <li>
    <p>You’ve successfully run the <code class="highlighter-rouge">carauction-network</code>  sample! If you want to continue to use this business network in future tutorials or for testing, click <strong>Export</strong> in the <strong>Define</strong> tab to download a Business Network Archive <code class="highlighter-rouge">.bna</code> file. A <code class="highlighter-rouge">.bna</code> file contains all files listed in the business network, in this example, <code class="highlighter-rouge">README.md</code>, <code class="highlighter-rouge">lib/logic.js</code>, <code class="highlighter-rouge">lib/org.acme.vehicle.auction.cto</code>, and <code class="highlighter-rouge">permissions.acl</code>.</p>
  </li>
</ol>

<p>If you want to continue to modify your business network, you could add some new fields to asset types in the business network definition, for example, make or model for <em>Vehicle</em> assets.</p>

<hr />
