<div *ngIf="connectionProfileData">
    <!-- EDIT V0.6 CONNECTION PROFILE -->

    <div *ngIf="connectionProfileData.profile.type === 'hlf'" class="edit-data">
        <form [formGroup]="v06Form" (ngSubmit)="onSubmit()" (keydown)="onSubmit($event)">
            <section>
                <div class="section-title">Basic Configuration</div>
                <div class="profile-row">
                    <div class="profile-property">
                        Connection Profile Name*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.name}" type="text" formControlName="name">
                        <div *ngIf="v06FormErrors.name" class="error-message">
                            {{ v06FormErrors.name }}
                        </div>
                    </div>
                </div>

                <div class="profile-row">
                    <div class="profile-property">
                        Profile Description
                    </div>
                    <div class="profile-value">
                        <textarea formControlName="description" rows="4"></textarea>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Peer URL*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.peerURL}" type="text"
                               formControlName="peerURL">
                        <div *ngIf="v06FormErrors.peerURL" class="error-message">
                            {{ v06FormErrors.peerURL }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Membership Services URL*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.membershipServicesURL}" type="text"
                               formControlName="membershipServicesURL">
                        <div *ngIf="v06FormErrors.membershipServicesURL" class="error-message">
                            {{ v06FormErrors.membershipServicesURL }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Event Hub URL*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.eventHubURL}" type="text"
                               formControlName="eventHubURL">
                        <div *ngIf="v06FormErrors.eventHubURL" class="error-message">
                            {{ v06FormErrors.eventHubURL }}
                        </div>
                    </div>
                </div>

                <div class="profile-row">
                    <div class="profile-property">
                        Key Value Store Directory Path*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.keyValStore}" type="text"
                               formControlName="keyValStore">
                        <div *ngIf="v06FormErrors.keyValStore" class="error-message">
                            {{ v06FormErrors.keyValStore }}
                        </div>
                    </div>
                </div>
            </section>
            <section>
                <div class="section-title">Security Settings</div>
                <div class="profile-row">
                    <div class="profile-property">
                        Certificate
                    </div>
                    <div class="profile-value">
                        <input type="text" formControlName="certificate">
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Certificate Path
                    </div>
                    <div class="profile-value">
                        <input type="text" formControlName="certificatePath">
                    </div>
                </div>
                <div class="section-title">Advanced</div>
                <div class="profile-row">
                    <div class="profile-property">
                        Deploy Wait Time (seconds)
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.deployWaitTime}" type="text"
                               formControlName="deployWaitTime">
                        <div *ngIf="v06FormErrors.deployWaitTime" class="error-message">
                            {{ v06FormErrors.deployWaitTime }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Invoke Wait Time (seconds)
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v06FormErrors.invokeWaitTime}" type="text"
                               formControlName="invokeWaitTime">
                        <div *ngIf="v06FormErrors.invokeWaitTime" class="error-message">
                            {{ v06FormErrors.invokeWaitTime }}
                        </div>
                    </div>
                </div>
            </section>
            <footer>
                <div class="info"></div>
                <button class="secondary" (click)="stopEditing()">Cancel</button>
                <button class="primary" type="submit" [disabled]="!v06Form.valid">Save</button>
            </footer>
        </form>
    </div>


    <!-- EDIT V1 CONNECTION PROFILE -->

    <div *ngIf="connectionProfileData.profile.type === 'hlfv1'" class="edit-data">
        <form [formGroup]="v1Form" (ngSubmit)="onSubmit()" (keydown)="onSubmit($event)">
            <section>
                <div class="section-title">Basic Configuration</div>
                <div class="profile-row">
                    <div class="profile-property">
                        Connection Profile Name*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v1FormErrors.name}" type="text" formControlName="name">
                        <div *ngIf="v1FormErrors.name" class="error-message">
                            {{ v1FormErrors.name }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Profile Description
                    </div>
                    <div class="profile-value">
                        <textarea formControlName="description" rows="4"></textarea>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Orderer(s)*
                    </div>
                    <div class="profile-value margin-right">
                        <div formArrayName="orderers"
                             *ngFor="let orderer of v1Form.controls.orderers.controls; let i=index">
                            <div class="profile-row" [formGroupName]="i">
                                <input [ngClass]="{'error-underline': v1FormErrors.orderers.url}"
                                       class="margin-right flex" type="text" formControlName="url">
                                <div *ngIf="v1FormErrors.orderers.url" class="error-message">
                                    {{ v1FormErrors.orderers.url }}
                                </div>
                                <input hidden type="text" formControlName="cert">
                                <button type="button"
                                        [ngClass]="{'certificate-button':true, 'no-cert': v1Form.controls.orderers.controls[i].value.cert === ''}"
                                        (click)="openAddCertificateModal(i,'orderers');">
                                    <svg class="standard-icon" aria-hidden="true">
                                        <use xlink:href="#icon-data-quality_16"></use>
                                    </svg>
                                </button>
                            </div>
                        </div>


                        <div *ngIf="v1FormErrors.orderers.cert" class="error-message">
                            {{ v1FormErrors.orderers.cert }}
                        </div>
                    </div>

                    <div class="profile-buttons">
                        <button type="button" class="secondary" (click)="addOrderer()">+ Add another</button>
                        <button type="button" class="secondary" *ngIf="v1Form.controls.orderers.controls.length > 1"
                                (click)="removeOrderer((v1Form.controls.orderers.controls.length - 1))">Remove orderer
                        </button>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Channel*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v1FormErrors.channel}" type="text"
                               formControlName="channel">
                        <div *ngIf="v1FormErrors.channel" class="error-message">
                            {{ v1FormErrors.channel }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        MSP ID*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v1FormErrors.mspID}" type="text" formControlName="mspID">
                        <div *ngIf="v1FormErrors.mspID" class="error-message">
                            {{ v1FormErrors.mspID }}
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Certificate Authority (CA)*
                    </div>
                    <div class="profile-value">
                        <div class="nested-section" formGroupName="ca">
                            <div class="nested-row">
                                <div class="nested-property">
                                    CA URL*
                                </div>
                                <div class="nested-value margin-right">
                                    <input [ngClass]="{'error-underline': v1FormErrors.ca.url}" type="text"
                                           formControlName="url">
                                    <div *ngIf="v1FormErrors.ca.url" class="error-message">
                                        {{ v1FormErrors.ca.url}}
                                    </div>
                                </div>
                            </div>
                            <div class="nested-row">
                                <div class="nested-property">
                                    CA Name
                                </div>
                                <div class="nested-value margin-right">
                                    <input type="text" formControlName="name">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Peer(s)*
                    </div>
                    <div class="profile-value margin-right">
                        <div formArrayName="peers" class="nested-group"
                             *ngFor="let peer of v1Form.controls.peers.controls; let i=index">
                            <div class="nested-section" [formGroupName]="i">
                                <div class="nested-row">
                                    <div class="nested-property">
                                        Peer Request URL*
                                    </div>
                                    <div class="nested-value margin-right">
                                        <input [ngClass]="{'error-underline': v1FormErrors.peers.requestURL}"
                                               type="text" formControlName="requestURL">
                                        <div *ngIf="v1FormErrors.peers.requestURL" class="error-message">
                                            {{ v1FormErrors.peers.requestURL }}
                                        </div>
                                    </div>
                                    <button type="button"
                                            [ngClass]="{'certificate-button':true, 'no-cert': v1Form.controls.peers.controls[i].value.cert === ''}"
                                            (click)="openAddCertificateModal(i,'peers');">
                                        <svg class="standard-icon" aria-hidden="true">
                                            <use xlink:href="#icon-data-quality_16"></use>
                                        </svg>
                                    </button>

                                </div>
                                <div class="nested-row">
                                    <div class="nested-property">
                                        Peer Event URL*
                                    </div>
                                    <div class="nested-value">
                                        <input [ngClass]="{'error-underline': v1FormErrors.peers.eventURL}"
                                               class="margin-right" type="text" formControlName="eventURL">
                                        <div *ngIf="v1FormErrors.peers.eventURL" class="error-message">
                                            {{ v1FormErrors.peers.eventURL }}
                                        </div>
                                        <input hidden type="text" formControlName="cert">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="profile-buttons">
                        <button type="button" class="secondary" (click)="addPeer()">+ Add another</button>
                        <button type="button" class="secondary" *ngIf="v1Form.controls.peers.controls.length > 1"
                                (click)="removePeer((v1Form.controls.orderers.controls.length - 1))">Remove Peer
                        </button>
                    </div>
                </div>
                <div class="profile-row">
                    <div class="profile-property">
                        Key Value Store Directory Path*
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v1FormErrors.keyValStore}" type="text"
                               formControlName="keyValStore">
                        <div *ngIf="v1FormErrors.keyValStore" class="error-message">
                            {{ v1FormErrors.keyValStore }}
                        </div>
                    </div>
                </div>
            </section>
            <section>
                <div class="section-title">Advanced</div>
                <div class="profile-row">
                    <div class="profile-property">
                        Time out (seconds)
                    </div>
                    <div class="profile-value">
                        <input [ngClass]="{'error-underline': v1FormErrors.timeout}" type="text"
                               formControlName="timeout">
                        <div *ngIf="v1FormErrors.timeout" class="error-message">
                            {{ v1FormErrors.timeout }}
                        </div>
                    </div>
                </div>
            </section>
            <footer class="actions">
                <button class="secondary" (click)="stopEditing()">Cancel</button>
                <button class="primary" type="submit" [disabled]="!v1Form.valid">Save</button>
            </footer>
        </form>
    </div>
</div>

